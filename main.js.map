{"version":3,"file":"main.js","mappings":"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","sources":["webpack://ahj-diploma/webpack/bootstrap","webpack://ahj-diploma/./src/js/utils/element.js","webpack://ahj-diploma/webpack/runtime/publicPath","webpack://ahj-diploma/./src/js/components/icons.js","webpack://ahj-diploma/./src/js/components/Message.js","webpack://ahj-diploma/./src/js/utils/textfilter.js","webpack://ahj-diploma/./src/js/utils/createMessageBody.js","webpack://ahj-diploma/./src/js/components/Chatbot.js","webpack://ahj-diploma/./src/js/utils/changeHandler.js","webpack://ahj-diploma/./src/js/utils/dragndrop.js","webpack://ahj-diploma/./src/js/components/constants.js","webpack://ahj-diploma/./src/js/components/Loader.js","webpack://ahj-diploma/./src/js/components/AddFilePopup.js","webpack://ahj-diploma/./src/js/utils/bytesToSIze.js","webpack://ahj-diploma/./src/js/components/botdata.js","webpack://ahj-diploma/./src/js/utils/resize.js","webpack://ahj-diploma/./src/js/utils/sendMessage.js","webpack://ahj-diploma/./src/js/components/AudioVideoRecorder.js","webpack://ahj-diploma/./src/js/app.js","webpack://ahj-diploma/./src/js/utils/createPinned.js","webpack://ahj-diploma/./src/js/utils/getPosition.js"],"sourcesContent":["// The require scope\nvar __webpack_require__ = {};\n\n","// создание DOM-элемента\n\nexport default function element(tagname, classname = '', content = '') {\n  const el = document.createElement(tagname);\n  el.className = classname;\n  if (content) el.textContent = content;\n  return el;\n}\n","__webpack_require__.p = \"\";","import fileIcon from '../../img/icons/file.svg';\nimport imageIcon from '../../img/icons/file-image.svg';\nimport audioIcon from '../../img/icons/file-audio.svg';\nimport videoIcon from '../../img/icons/file-video.svg';\n\n// иконки для типов файла\n\nconst icons = {\n  file: fileIcon,\n  image: imageIcon,\n  audio: audioIcon,\n  video: videoIcon,\n};\n\nexport default icons;\n","import textfilter from '../utils/textfilter';\nimport element from '../utils/element';\nimport icons from './icons';\n\n// класс для обработки входящих с сервера сообщений по содержимому контенту, взаимодействие с закреплением и добавлением в избранное\n\nexport default class Message {\n  constructor(data, server) {\n    this.server = server;\n    this.id = data.id;\n    this.usertype = data.usertype;\n    this.username = data.username;\n    this.date = new Date(data.date);\n    this.content = data.content;\n    this.favorite = data.favorite;\n    this.pinned = data.pinned;\n  }\n\n  render() {\n    this.messageEl = element('li', 'messanger__message message-messanger');\n    this.messageEl.classList.add(\n      this.usertype === 'bot' ? 'bot-message' : 'user-message'\n    );\n    this.messageEl.dataset.id = this.id;\n\n    this.messageInfoEl = element('div', 'message-messanger__info');\n    this.messageAuthorEl = element(\n      'span',\n      'message-messanger__author',\n      this.usertype !== 'bot' ? 'You' : this.username\n    );\n    this.messageDateEl = element(\n      'span',\n      'message-messanger__date',\n      this.formatDate(this.date)\n    );\n    this.messageInfoEl.appendChild(this.messageAuthorEl);\n    this.messageInfoEl.appendChild(this.messageDateEl);\n\n    this.messageContentEl = element(\n      'div',\n      'message-messanger__content content'\n    );\n    this.contentMediaEl = element('div', 'content__media');\n    this.mediaImagesEl = element('div', 'content__images');\n    this.checkType(\n      this.messageContentEl,\n      this.contentMediaEl,\n      this.mediaImagesEl\n    );\n    this.messageEl.appendChild(this.messageInfoEl);\n    this.messageEl.appendChild(this.messageContentEl);\n    this.messageContentEl.appendChild(this.contentMediaEl);\n    this.contentMediaEl.appendChild(this.mediaImagesEl);\n\n    this.messagesControllers = element(\n      'div',\n      'message-messanger__controllers message-controllers'\n    );\n    this.pinBtn = element('button', 'message-controllers__pin messanger-btn');\n    this.favoriteBtn = element(\n      'button',\n      'message-controllers__favorite messanger-btn'\n    );\n    if (this.favorite) {\n      this.favoriteBtn.classList.add('added');\n    }\n    this.messagesControllers.appendChild(this.pinBtn);\n    this.messagesControllers.appendChild(this.favoriteBtn);\n\n    this.pinBtn.addEventListener('click', () => this.pin());\n    this.favoriteBtn.addEventListener('click', () => this.addToFavorite());\n\n    this.messageEl.appendChild(this.messagesControllers);\n    ``;\n    return this.messageEl;\n  }\n\n  checkType(contentEl, mediaEl, mediaImages) {\n    this.content.forEach((el) => {\n      switch (el.type) {\n        case 'text':\n          const textEl = element('span', 'content__text');\n          textEl.innerHTML = textfilter(el.body);\n          contentEl.appendChild(textEl);\n          break;\n        case 'video':\n          const videoWrapper = element('div', 'content__video');\n          const videoEl = element('video');\n          videoEl.src = el.body;\n          videoEl.controls = true;\n          videoWrapper.appendChild(videoEl);\n          const videoLoader = element(\n            'a',\n            'content__download-btn messanger-btn'\n          );\n          videoLoader.href = el.body;\n          videoLoader.download = el.filename;\n          videoWrapper.appendChild(videoLoader);\n          mediaEl.appendChild(videoWrapper);\n          break;\n        case 'audio':\n          const audioWrapper = element('div', 'content__audio');\n          const audioTitle = element(\n            'span',\n            'content__audio-name',\n            el.filename\n          );\n          audioWrapper.appendChild(audioTitle);\n          const audioEl = element('audio');\n          audioEl.src = el.body;\n          audioEl.controls = 'true';\n          audioWrapper.appendChild(audioEl);\n          const audioLoader = element(\n            'a',\n            'content__download-btn messanger-btn'\n          );\n          audioLoader.href = el.body;\n          audioLoader.download = el.filename;\n          audioWrapper.appendChild(audioLoader);\n          mediaEl.appendChild(audioWrapper);\n          break;\n        case 'location':\n          const locationEl = element('span', 'content__location');\n          locationEl.innerHTML = `📍 Your current location - <a href=\"https://www.google.com/maps/search/?api=1&query=${el.body}\" target=\"_blank\">${el.body}</a>`;\n          contentEl.appendChild(locationEl);\n          break;\n        case 'image':\n          const imageWrapper = element('div', 'content__image');\n          const imageEl = element('img');\n          imageWrapper.appendChild(imageEl);\n          imageEl.src = el.body;\n          const imgLoader = element('a', 'content__download-btn messanger-btn');\n          imgLoader.href = el.body;\n          imgLoader.download = el.filename;\n          imageWrapper.appendChild(imgLoader);\n          mediaImages.appendChild(imageWrapper);\n          break;\n        default:\n          const fileWrapper = element('div', 'content__file');\n          const fileEl = element('img')\n          fileEl.src = icons.file;\n          fileWrapper.appendChild(fileEl);\n          const fileTitle = element('span', 'content__file-name', el.filename);\n          fileWrapper.appendChild(fileTitle);\n          const fileLoader = element('a', 'content__download-btn messanger-btn');\n          fileLoader.href = el.body;\n          fileLoader.download = el.filename;\n          fileWrapper.appendChild(fileLoader); \n          contentEl.appendChild(fileWrapper);\n          return;\n      }\n    });\n  }\n\n  addToFavorite() {\n    if (this.favorite) {\n      this.favorite = false;\n      this.favoriteBtn.classList.remove('added');\n    } else {\n      this.favorite = true;\n      this.favoriteBtn.classList.add('added');\n    }\n    this.server.send(\n      JSON.stringify({\n        addToFavorite: true,\n        favorite: this.favorite,\n        id: this.messageEl.dataset.id,\n      })\n    );\n  }\n\n  pin() {\n    this.pinned = true;\n    this.server.send(\n      JSON.stringify({\n        pinMessage: true,\n        pinned: this.pinned,\n        id: this.messageEl.dataset.id,\n      })\n    );\n  }\n\n  formatDate(date) {\n    const hour = date.getHours() < 10 ? `0${date.getHours()}` : date.getHours();\n    const minute =\n      date.getMinutes() < 10 ? `0${date.getMinutes()}` : date.getMinutes();\n    const formattedDate = `${hour}:${minute}`;\n\n    return formattedDate;\n  }\n}\n","// фильтрация вводимого сообщение на наличие ссылок\n\nexport default function (str) {\n  var re = /([^\\\"=]{2}|^)((https?|ftp):\\/\\/\\S+[^\\s.,> )\\];'\\\"!?])/;\n  var subst = '$1<a href=\"$2\" target=\"_blank\">$2</a>';\n  return str.replace(re, subst);\n}\n","// создает тело сообщения, где:\n// usertype - тип юзера (бот/пользователь)\n// content - контент сообщения\n// botname - имя бота\n\nexport default function createMessageBody(usertype, content, botname = '') {\n  return JSON.stringify({\n    usertype: usertype,\n    botname: botname,\n    content: content,\n    pinned: false,\n    favorite: false,\n  });\n}\n","import createMessageBody from '../utils/createMessageBody';\n\n// класс для обработки ботом входящих команд\n\nexport default class Chatbot {\n  constructor(botname, data, server) {\n    this.botname = botname;\n    this.description = `Привет! Меня зовут ${botname}. Если ты заскучал, я помогу тебе выбрать какой-нибудь зарубежный сериал или фильм и даже игру на ПК. Чтобы обратиться ко мне, начни свое сообщение со слэша (\"/\") и напиши одну из команд: \"hello\", \"bye\", \"serial\", \"film\", \"game\". Например: \"/serial\".`;\n    this.greeting = data?.greeting;\n    this.goodbye = data?.goodbye;\n    this.serials = data?.serials;\n    this.games = data?.games;\n    this.server = server;\n\n    this.greet();\n  }\n\n  reply(request) {\n    if (!/^\\//.test(request)) return;\n    let message;\n\n    switch (request) {\n      case '/hello':\n        message = createMessageBody(\n          'bot',\n          [{ type: 'text', body: this.random(this.greeting) }],\n          this.botname\n        );\n        this.server.send(message);\n        break;\n\n      case '/bye':\n        message = createMessageBody(\n          'bot',\n          [{ type: 'text', body: this.random(this.goodbye) }],\n          this.botname\n        );\n        this.server.send(message);\n        break;\n\n      case '/serial':\n        message = createMessageBody(\n          'bot',\n          [{ type: 'text', body: this.random(this.serials) }],\n          this.botname\n        );\n        this.server.send(message);\n        break;\n\n      case '/film':\n        fetch('https://kinopoiskapiunofficial.tech/api/v2.2/films', {\n          method: 'GET',\n          headers: {\n            'X-API-KEY': '2abdabef-3994-4107-8e8d-39dd2e2edcda',\n            'Content-Type': 'application/json',\n          },\n        })\n          .then((res) => res.json())\n          .then((json) => {\n            const film = this.random(json.items);\n            message = createMessageBody(\n              'bot',\n              [\n                { type: 'text', body: film.nameOriginal },\n                { type: 'image', body: film.posterUrlPreview },\n              ],\n              this.botname\n            );\n            this.server.send(message);\n          })\n          .catch((err) => {\n            throw new Error(err);\n          });\n\n        break;\n\n      case '/game':\n        message = createMessageBody(\n          'bot',\n          [{ type: 'text', body: this.random(this.games) }],\n          this.botname\n        );\n        this.server.send(message);\n        break;\n\n      default:\n        message = createMessageBody(\n          'bot',\n          [\n            {\n              type: 'text',\n              body: 'К сожалению, данная команда пока что не доступна мне. Попробуй еще раз написать точнее :)',\n            },\n          ],\n          this.botname\n        );\n\n        this.server.send(message);\n    }\n  }\n\n  greet() {\n    const message = {\n      greet: true,\n      usertype: 'bot',\n      botname: this.botname,\n      content: [{ type: 'text', body: this.description }],\n    };\n\n    this.server.send(JSON.stringify(message));\n  }\n\n  random(arr) {\n    const randomIndex = Math.floor(Math.random() * arr.length);\n    return arr[randomIndex];\n  }\n}\n","// обработчик события добавления файлов\n\nexport default function changeHandler(event, popup, eventName = 'change') {\n  const data = eventName === 'drop' ? event.dataTransfer : event.target;\n  if (!data.files.length) {\n    return;\n  }\n\n  const files = Array.from(data.files);\n  files.forEach((file) => {\n\n    const reader = new FileReader();\n\n    reader.onload = (ev) => {\n      const src = ev.target.result;\n\n      if (!document.querySelector('.add-file-popup')) {\n        document.body.appendChild(popup.render());\n        popup.addFile(file, src);\n      } else {\n        popup.addFile(file, src);\n      }\n    };\n\n    reader.readAsDataURL(file);\n  });\n}\n","import changeHandler from './changeHandler';\n\n// обработка событий движения мыши в области добавления файла\n\nexport default function dragndropAddListeners(target, popup) {\n  target.addEventListener('dragover', (event) => {\n    event.preventDefault();\n    const dragArea = event.currentTarget.querySelector('.droparea');\n    dragArea.classList.remove(null);\n  });\n  target.addEventListener('dragleave', (event) => {\n    const dragArea = event.currentTarget.querySelector('.droparea');\n    dragArea.classList.add(null);\n  });\n  target.addEventListener('drop', (event) => {\n    event.preventDefault();\n\n    const dragArea = event.currentTarget.querySelector('.droparea');\n    if (!dragArea) return;\n\n    changeHandler(event, popup, 'drop');\n    dragArea.classList.add(null);\n  });\n}\n","// объявление необходимых констант\n\nimport Loader from './Loader';\nconst messageForm = document.getElementById('message-form'),\n  typeMessageInput = document.getElementById('type-message'),\n  chatContainer = document.querySelector('.messanger__chat-container'),\n  chat = document.getElementById('chat'),\n  addFileInput = document.getElementById('add-file-input'),\n  addFileBtn = document.getElementById('add-file-btn'),\n  loader = new Loader(),\n  mediaButtons = document.querySelector('.messanger__composer-btns'),\n  mediaControllers = document.querySelector('.messanger__record-media'),\n  recAudioBtn = document.getElementById('rec-audio-btn'),\n  recVideoBtn = document.getElementById('rec-video-btn'),\n  clearMediaBtn = document.getElementById('clear-media-btn'),\n  sendMediaBtn = document.getElementById('send-media-btn'),\n  mediaTimer = document.getElementById('media-timer'),\n  searchForm = document.getElementById('search-form'),\n  searchInput = document.getElementById('search-message'),\n  noResultAlarm = document.querySelector('.messanger__no-search'),\n  showFavoriteBtn = document.getElementById('show-favorite-btn'),\n  sendGeoBtn = document.getElementById('send-geo-btn');\n\nexport {\n  messageForm,\n  typeMessageInput,\n  chat,\n  chatContainer,\n  addFileInput,\n  addFileBtn,\n  loader,\n  mediaButtons,\n  mediaControllers,\n  recAudioBtn,\n  recVideoBtn,\n  clearMediaBtn,\n  sendMediaBtn,\n  mediaTimer,\n  searchForm,\n  searchInput,\n  noResultAlarm,\n  showFavoriteBtn,\n  sendGeoBtn,\n};\n","import element from '../utils/element';\n\n// спиннер загрузки при загрузке файлов\n\nexport default class Loader {\n  render() {\n    this.loaderEl = element('div', 'loader');\n    this.loaderEl.innerHTML = `\n  <svg version=\"1.1\" id=\"loader-1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" x=\"0px\" y=\"0px\"\n     width=\"40px\" height=\"40px\" viewBox=\"0 0 50 50\" style=\"enable-background:new 0 0 50 50;\" xml:space=\"preserve\">\n  <path fill=\"#000\" d=\"M43.935,25.145c0-10.318-8.364-18.683-18.683-18.683c-10.318,0-18.683,8.365-18.683,18.683h4.068c0-8.071,6.543-14.615,14.615-14.615c8.072,0,14.615,6.543,14.615,14.615H43.935z\">\n    <animateTransform attributeType=\"xml\"\n      attributeName=\"transform\"\n      type=\"rotate\"\n      from=\"0 25 25\"\n      to=\"360 25 25\"\n      dur=\"0.6s\"\n      repeatCount=\"indefinite\"/>\n    </path>\n  </svg>`;\n    return this.loaderEl;\n  }\n}\n","import bytesToSize from '../utils/bytesToSIze';\nimport element from '../utils/element';\nimport changeHandler from '../utils/changeHandler';\nimport dragndropAddListeners from '../utils/dragndrop';\nimport icons from './icons';\nimport createMessageBody from '../utils/createMessageBody';\nimport { chat, loader } from './constants';\n\n// popup для добавления и отправки файлов на сервер\n\nexport default class AddFilePopup {\n\tconstructor(server) {\n\t\tthis.server = server;\n\t\tthis.content = [];\n\t}\n\n\trender() {\n\t\tthis.popup = element('div', 'add-file-popup');\n\t\tthis.popupOverlay = element('div', 'add-file-popup__overlay');\n\t\tthis.popup.appendChild(this.popupOverlay);\n\n\t\tthis.popupBody = element('div', 'add-file-popup__body');\n\t\tthis.popupOverlay.appendChild(this.popupBody);\n\t\tdragndropAddListeners(this.popupBody, this);\n\n\t\tthis.popupFiles = element('div', 'add-file-popup__files');\n\t\tthis.popupBody.appendChild(this.popupFiles);\n\n\t\tthis.popupControllers = element('div', 'add-file-popup__controllers');\n\t\tthis.popupBody.appendChild(this.popupControllers);\n\n\t\tthis.controllersLeft = element('div', 'controllers__left');\n\t\tthis.popupControllers.appendChild(this.controllersLeft);\n\n\t\tthis.addFileBtn = element(\n\t\t\t'button',\n\t\t\t'controllers__add-btn popup-btn',\n\t\t\t'add'\n\t\t);\n\t\tthis.controllersLeft.appendChild(this.addFileBtn);\n\n\t\tthis.addFileInput = element('input', 'controllers__add-input null');\n\t\tthis.addFileInput.type = 'file';\n\t\tthis.addFileInput.setAttribute('multiple', true);\n\t\tthis.controllersLeft.appendChild(this.addFileInput);\n\n\t\tthis.addFileBtn.addEventListener('click', () => this.addFileInput.click());\n\t\tthis.addFileInput.addEventListener('change', (event) => {\n\t\t\tchangeHandler(event, this);\n\t\t\tevent.currentTarget.value = '';\n\t\t});\n\n\t\tthis.controllersRight = element('div', 'controllers__right');\n\t\tthis.popupControllers.appendChild(this.controllersRight);\n\t\tthis.cancelBtn = element(\n\t\t\t'button',\n\t\t\t'controllers__cancel-btn popup-btn',\n\t\t\t'cancel'\n\t\t);\n\t\tthis.controllersRight.appendChild(this.cancelBtn);\n\t\tthis.cancelBtn.addEventListener('click', () => this.removeEl(this.popup));\n\n\t\tthis.sendBtn = element('button', 'controllers__send-btn popup-btn', 'send');\n\t\tthis.controllersRight.appendChild(this.sendBtn);\n\t\tthis.sendBtn.addEventListener('click', () => {\n\t\t\tconst message = createMessageBody('person', this.content);\n\t\t\tthis.server.send(message);\n\t\t\tchat.appendChild(loader.render());\n\t\t\tthis.content = [];\n\t\t\tthis.removeEl(this.popup);\n\t\t});\n\n\t\tthis.dragArea = element('div', 'add-file-popup__droparea droparea null');\n\t\tthis.dragArea.innerHTML = `<b>Drop files here</b> <br>to send them`;\n\t\tthis.popupBody.appendChild(this.dragArea);\n\n\t\treturn this.popup;\n\t}\n\n\taddFile(file, src) {\n\t\tif (!this.popupFiles) return;\n\t\tconsole.log(file);\n\n\t\tconst fileEl = element('div', 'add-file-popup__file file');\n\t\tconst fileLeft = element('div', 'file__left');\n\t\tfileEl.appendChild(fileLeft);\n\t\tconst fileIcon = element('img', 'file__icon');\n\t\tfileIcon.src = this.checkFileType(file);\n\n\t\tfileLeft.appendChild(fileIcon);\n\n\t\tconst fileInfo = element('div', 'file__info');\n\t\tfileLeft.appendChild(fileInfo);\n\n\t\tconst fileTitle = element('div', 'file__title', file.name);\n\t\tconst fileSize = element('div', 'file__size', bytesToSize(file.size));\n\t\tfileInfo.appendChild(fileTitle);\n\t\tfileInfo.appendChild(fileSize);\n\n\t\tconst deleteBtn = element('button', 'file__delete-btn messanger-btn');\n\t\tfileEl.appendChild(deleteBtn);\n\t\tdeleteBtn.addEventListener('click', async () => {\n\t\t\tawait this.removeEl(fileEl);\n\t\t\tif (!this.popupFiles.children.length) {\n\t\t\t\tthis.cancelBtn.click();\n\t\t\t}\n\t\t});\n\n\t\tthis.popupFiles.appendChild(fileEl);\n\t\tthis.content.push({\n\t\t\ttype: file.type.split('/')[0],\n\t\t\tbody: src,\n\t\t\tfilename: file.name,\n\t\t});\n\t}\n\n\tasync removeEl(el) {\n\t\treturn new Promise((res, rej) => {\n\t\t\tel.classList.toggle('removing');\n\t\t\tsetTimeout(() => {\n\t\t\t\tel.remove();\n\t\t\t\tres(true);\n\t\t\t}, 400);\n\t\t});\n\t}\n\n\tcheckFileType(file) {\n\t\tif (file.type.match('image')) {\n\t\t\treturn icons.image;\n\t\t} else if (file.type.match('audio')) {\n\t\t\tconsole.log(icons.audio);\n\t\t\treturn icons.audio;\n\t\t} else if (file.type.match('video')) {\n\t\t\treturn icons.video;\n\t\t} else {\n\t\t\treturn icons.file;\n\t\t}\n\t}\n}\n","// конвертирование размера файла\n\nexport default function bytesToSize(bytes) {\n  const sizes = ['Bytes', 'KB', 'MB', 'GB', 'TB'];\n  if (!bytes) {\n    return '0 Byte';\n  }\n  const i = parseInt(Math.floor(Math.log(bytes) / Math.log(1024)));\n  return Math.round(bytes / Math.pow(1024, i)) + ' ' + sizes[i];\n}\n","// данные для ответа бота на команды\n\nconst botdata = {\n  greeting: [\n    'Только тебя вспомнил, это к богатству!',\n    'Привет! Как же я тебя ждал!',\n    'Буэнос диас!',\n    'И тебе не хворать :)',\n    'Какие люди и без охраны :)',\n    'Посмотрите-ка, кто здесь?!',\n    'Что новенького?',\n    'Сколько лет, сколько зим!',\n    'Нет ничего лучше, чем встретить старого друга :)',\n    'Aloha!',\n  ],\n  goodbye: [\n    'Да прибудет с тобой сила!',\n    'Hasta la vista, baby!',\n    'Прощай!',\n    'Возвращайся, я буду рад :)',\n    'Если что, я рядом :)',\n    'До связи!',\n    'Я думаю это начало прекрасной дружбы :)',\n    'Я бы поговорил дольше, но ко мне пожаловал старый друг. Прощай!',\n    'До связи!',\n    'Только не сжигай мосты и возвращайся скорее!',\n  ],\n  serials: [\n    'Игра престолов',\n    'Половое воспитание',\n    'Локи',\n    'Острые козырьки',\n    'Видеть',\n    'Во все тяжкие',\n    'Очень странные дела',\n    'Голяк',\n    'Отбросы',\n    'Ход королевы',\n    'Пацаны',\n    '13 причин почему',\n    'Элита',\n    'Бумажный дом',\n    'Игра в кальмара',\n    'Клиника',\n    'Доктор хауc',\n    'Теория большого взрыва',\n    'Тед Лассо',\n    'Защищая Джейкоба',\n    'Дом с прислугой',\n    'Лунный рыцарь',\n    'Остаться в живых',\n    'Ведьмак',\n    'Магическая битва',\n    'Клинок, рассекающий демонов',\n    'Тетрадь смерти',\n  ],\n  games: [\n    'Dota 2',\n    'The Witcher 3',\n    '2k22',\n    'Grand Theft Auto V',\n    'God of War',\n    'Elden Ring',\n    'The Elder Scrolls V: Skyrim',\n    'Aion',\n    'Stray',\n    'Red Dead Redemption 2',\n    'Bioshock Infinite',\n    'Far Cry 3',\n    'Need for Speed: Most Wanted',\n    'Black Desert',\n    'Fortnite',\n    'Path of Exile',\n    'League of Legends',\n    'World of Warcraft',\n    'APEX Legends',\n    'Left 4 Dead',\n    'Blade & Soul',\n    'Forza Horizon 4',\n    'Destiny 2',\n    'Warframe',\n    'Death Stranding',\n  ],\n};\n\nexport default botdata;\n","// динамическая высота тестового поля для воода сообщения\n\nexport default function resize(target, height) {\n  target.style.height = height;\n  target.style.height = target.scrollHeight + 'px';\n}\n","import resize from './resize';\n\n// отправка сообщения боту\n\nexport default function sendMessage(server, messageBody, bot, form, input) {\n  server.send(messageBody);\n  const messageToBot = JSON.parse(messageBody).content.find(\n    (cnt) => cnt.type === 'text'\n  );\n  bot.reply(messageToBot.body);\n  form.reset();\n  resize(input, '50px');\n}\n","import {\n\tmediaButtons,\n\tmediaControllers,\n\trecAudioBtn,\n\trecVideoBtn,\n\tclearMediaBtn,\n\tsendMediaBtn,\n\tmediaTimer,\n} from './constants';\nimport element from '../utils/element';\nimport createMessageBody from '../utils/createMessageBody';\n\n// запись аудио- и видеосообщений и отправка их на сервер\n\nexport default class AudioVideoRecorder {\n\tconstructor(server) {\n\t\tthis.server = server;\n\t}\n\tinit() {\n\t\trecAudioBtn.addEventListener('click', () => {\n\t\t\tmediaButtons.classList.add('null');\n\t\t\tmediaControllers.classList.remove('null');\n\t\t\tmediaControllers.classList.add('show');\n\t\t\tthis.audioRecorder();\n\t\t});\n\n\t\trecVideoBtn.addEventListener('click', () => {\n\t\t\tmediaButtons.classList.add('null');\n\t\t\tmediaControllers.classList.remove('null');\n\t\t\tmediaControllers.classList.add('show');\n\t\t\tthis.audioRecorder(true);\n\t\t});\n\t}\n\n\tasync audioRecorder(recVideo = false) {\n\t\tif (!navigator.mediaDevices) {\n\t\t\tthrow new Error(\n\t\t\t\t'Audio and video recording are not supported by the browser.'\n\t\t\t);\n\t\t\trecAudioBtn.disable = true;\n\t\t\trecVideoBtn.disable = true;\n\t\t\treturn;\n\t\t}\n\t\ttry {\n\t\t\tlet save = true;\n\t\t\tlet time = 0;\n\t\t\tlet timer = null;\n\n\t\t\tif (!window.MediaRecorder) {\n\t\t\t\tthrow new Error('The browser needs permission to record media.');\n\t\t\t\trecAudioBtn.disable = true;\n\t\t\t\trecVideoBtn.disable = true;\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\trecAudioBtn.disable = false;\n\t\t\trecVideoBtn.disable = false;\n\n\t\t\tconst stream = await navigator.mediaDevices.getUserMedia({\n\t\t\t\taudio: true,\n\t\t\t\tvideo: recVideo,\n\t\t\t});\n\n\t\t\tif (recVideo) {\n\t\t\t\tconst preview = element('video', 'video-preview');\n\t\t\t\tpreview.controls = true;\n\t\t\t\tpreview.muted = 'muted';\n\t\t\t\tpreview.srcObject = stream;\n\t\t\t\tdocument.body.appendChild(preview);\n\t\t\t\tpreview.play();\n\t\t\t}\n\n\t\t\tconst recorder = new MediaRecorder(stream);\n\t\t\tconst chunks = [];\n\n\t\t\trecorder.start();\n\n\t\t\trecorder.addEventListener('start', () => {\n\t\t\t\ttimer = setInterval(() => {\n\t\t\t\t\tmediaTimer.textContent = this.setTimer(time++);\n\t\t\t\t}, 1000);\n\t\t\t});\n\n\t\t\trecorder.addEventListener('dataavailable', (evt) => {\n\t\t\t\tchunks.push(evt.data);\n\t\t\t});\n\n\t\t\trecorder.addEventListener('stop', async () => {\n\t\t\t\tclearInterval(timer);\n\t\t\t\tmediaTimer.textContent = '00:00';\n\t\t\t\tif (save) {\n\t\t\t\t\tlet mediaType = 'audio';\n\t\t\t\t\tif (recVideo) {\n\t\t\t\t\t\tmediaType = 'video';\n\t\t\t\t\t}\n\n\t\t\t\t\tconst blob = new Blob(chunks, { type: `${mediaType}/mp4` });\n\n\t\t\t\t\tconst fr = new FileReader();\n\t\t\t\t\tfr.readAsDataURL(blob);\n\n\t\t\t\t\tfr.onload = () => {\n\t\t\t\t\t\tconst src = fr.result;\n\n\t\t\t\t\t\tconst message = createMessageBody('person', [\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\ttype: mediaType,\n\t\t\t\t\t\t\t\tbody: src,\n\t\t\t\t\t\t\t\tfilename: 'Voice message',\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t]);\n\t\t\t\t\t\tthis.server.send(message);\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t\tif (recVideo) {\n\t\t\t\t\tdocument.querySelector('.video-preview').remove();\n\t\t\t\t}\n\t\t\t\tmediaControllers.classList.add('null');\n\t\t\t\tmediaButtons.classList.remove('null');\n\t\t\t\tmediaButtons.classList.add('show');\n\t\t\t});\n\n\t\t\tsendMediaBtn.addEventListener('click', () => {\n\t\t\t\trecorder.stop();\n\t\t\t\tstream.getTracks().forEach((track) => track.stop());\n\t\t\t\tsave = true;\n\t\t\t});\n\n\t\t\tclearMediaBtn.addEventListener('click', () => {\n\t\t\t\trecorder.stop();\n\t\t\t\tstream.getTracks().forEach((track) => track.stop());\n\t\t\t\tsave = false;\n\t\t\t});\n\t\t} catch (e) {\n\t\t\tthrow new Error('The browser needs permission to record media.');\n\t\t\trecAudioBtn.disable = true;\n\t\t\trecVideoBtn.disable = true;\n\t\t}\n\t}\n\n\tsetTimer(time) {\n\t\tconst minutes = Math.floor(time / 60);\n\t\tconst seconds = time - minutes * 60;\n\n\t\treturn `${minutes < 10 ? `0${minutes}` : minutes}:${seconds < 10 ? `0${seconds}` : seconds\n\t\t\t}`;\n\t}\n}\n","import Message from './components/Message';\nimport Chatbot from './components/Chatbot';\nimport AddFilePopup from './components/AddFilePopup';\nimport botdata from './components/botdata';\nimport resize from './utils/resize';\nimport changeHandler from './utils/changeHandler';\nimport dragndropAddListeners from './utils/dragndrop';\nimport createMessageBody from './utils/createMessageBody';\nimport sendMessage from './utils/sendMessage';\nimport AudioVideoRecorder from './components/AudioVideoRecorder';\nimport getPosition from './utils/getPosition';\nimport createPinned from './utils/createPinned';\n\nimport {\n\tmessageForm,\n\ttypeMessageInput,\n\tchat,\n\tchatContainer,\n\taddFileInput,\n\taddFileBtn,\n\tloader,\n\tsearchForm,\n\tsearchInput,\n\tnoResultAlarm,\n\tshowFavoriteBtn,\n\tsendGeoBtn,\n} from './components/constants';\n\nwindow.onload = () => {\n\t[...document.forms].forEach((form) => form.reset());\n\tconsole.log(navigator.mediaDevices);\n\tconst ws = new WebSocket('wss://ahj-diploma-server.onrender.com/ws');\n\n\tconsole.log(ws)\n\tlet allLoaded = false;\n\tws.onopen = () => {\n\t\tconst botCharlie = new Chatbot('Jarvis the Bot', botdata, ws);\n\t\tws.send(JSON.stringify({ init: true }));\n\t\tconst appRecorder = new AudioVideoRecorder(ws);\n\t\tappRecorder.init();\n\t\tconsole.log(appRecorder.audioRecorder(true));\n\t\tconst addPopup = new AddFilePopup(ws);\n\t\tlet favoriteShowed = false;\n\n\t\tws.onmessage = (message) => {\n\t\t\tif (loader.loaderEl) loader.loaderEl.remove();\n\t\t\tconst data = JSON.parse(message.data);\n\t\t\tif (data.search || data.init) {\n\t\t\t\tif (!data.messages.length) {\n\t\t\t\t\tnoResultAlarm.classList.remove('null');\n\t\t\t\t\tnoResultAlarm.classList.add('show');\n\t\t\t\t} else {\n\t\t\t\t\tnoResultAlarm.classList.add('null');\n\t\t\t\t\tnoResultAlarm.classList.remove('show');\n\t\t\t\t}\n\n\t\t\t\t[...chat.children].forEach((el) => el.remove());\n\t\t\t\tdata.messages.forEach((mes) => {\n\t\t\t\t\tconst el = new Message(mes, ws).render();\n\t\t\t\t\tif (mes.content) chat.appendChild(el);\n\t\t\t\t\tel.scrollIntoView({\n\t\t\t\t\t\tbehavior: 'smooth',\n\t\t\t\t\t\tblock: 'start',\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t} else if (data.lazyload) {\n\t\t\t\tdata.messages.forEach((mes) => {\n\t\t\t\t\tconst el = new Message(mes, ws).render();\n\t\t\t\t\tif (chat.firstChild)\n\t\t\t\t\t\tif (mes.content) chat.insertBefore(el, chat.firstChild);\n\t\t\t\t});\n\t\t\t} else if (data.allLoaded) {\n\t\t\t\tallLoaded = data.allLoaded;\n\t\t\t} else if (data.showFavorite) {\n\t\t\t\tif (!data.messages.length) {\n\t\t\t\t\tfavoriteShowed = false;\n\t\t\t\t\tshowFavoriteBtn.classList.remove('showed');\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tfavoriteShowed = true;\n\t\t\t\tshowFavoriteBtn.classList.add('showed');\n\t\t\t\t[...chat.children].forEach((el) => el.remove());\n\t\t\t\tdata.messages.forEach((mes) => {\n\t\t\t\t\tconst el = new Message(mes, ws).render();\n\t\t\t\t\tel.querySelector('.message-controllers').classList.add('null');\n\t\t\t\t\tif (mes.content) chat.appendChild(el);\n\t\t\t\t\tel.scrollIntoView({\n\t\t\t\t\t\tbehavior: 'smooth',\n\t\t\t\t\t\tblock: 'start',\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t} else if (data.showAll) {\n\t\t\t\t[...chat.children].forEach((el) => el.remove());\n\t\t\t\tdata.messages.forEach((mes) => {\n\t\t\t\t\tfavoriteShowed = false;\n\t\t\t\t\tshowFavoriteBtn.classList.remove('showed');\n\t\t\t\t\tconst el = new Message(mes, ws).render();\n\t\t\t\t\tif (mes.content) chat.appendChild(el);\n\t\t\t\t\tel.scrollIntoView({\n\t\t\t\t\t\tbehavior: 'smooth',\n\t\t\t\t\t\tblock: 'start',\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t} else if (data.pinMessage) {\n\t\t\t\tif (document.querySelector('.pinned-message')) {\n\t\t\t\t\tdocument.querySelector('.pinned-message').remove();\n\t\t\t\t}\n\t\t\t\tchat.insertAdjacentElement(\n\t\t\t\t\t'afterbegin',\n\t\t\t\t\tcreatePinned(data.message, ws)\n\t\t\t\t);\n\t\t\t} else {\n\t\t\t\tconst el = new Message(data, ws).render();\n\t\t\t\tif (data.content) chat.appendChild(el);\n\t\t\t\tel.scrollIntoView({\n\t\t\t\t\tbehavior: 'smooth',\n\t\t\t\t\tblock: 'start',\n\t\t\t\t});\n\t\t\t}\n\t\t};\n\n\t\tmessageForm.addEventListener('submit', function (event) {\n\t\t\tevent.preventDefault();\n\t\t\tif (typeMessageInput.value === '') {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tsendMessage(\n\t\t\t\tws,\n\t\t\t\tcreateMessageBody('person', [\n\t\t\t\t\t{ type: 'text', body: typeMessageInput.value },\n\t\t\t\t]),\n\t\t\t\tbotCharlie,\n\t\t\t\tthis,\n\t\t\t\ttypeMessageInput\n\t\t\t);\n\t\t});\n\t\ttypeMessageInput.addEventListener('keypress', function (event) {\n\t\t\tif (event.key === 'Enter' && !event.shiftKey) {\n\t\t\t\tevent.preventDefault();\n\t\t\t\tif (typeMessageInput.value === '') {\n\t\t\t\t\treturn;\n\t\t\t\t} else {\n\t\t\t\t\tsendMessage(\n\t\t\t\t\t\tws,\n\t\t\t\t\t\tcreateMessageBody('person', [\n\t\t\t\t\t\t\t{ type: 'text', body: typeMessageInput.value },\n\t\t\t\t\t\t]),\n\t\t\t\t\t\tbotCharlie,\n\t\t\t\t\t\tthis.closest('form'),\n\t\t\t\t\t\tthis\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t\taddFileInput.addEventListener('change', (event) => {\n\t\t\tchangeHandler(event, addPopup);\n\t\t\tevent.currentTarget.value = '';\n\t\t});\n\t\ttypeMessageInput.addEventListener('input', (event) => {\n\t\t\tresize(event.target, '50px');\n\t\t});\n\t\tsearchForm.addEventListener('submit', function (event) {\n\t\t\tevent.preventDefault();\n\t\t\tconst request = {\n\t\t\t\tsearch: true,\n\t\t\t\tvalue: searchInput.value.toLowerCase(),\n\t\t\t};\n\t\t\tws.send(JSON.stringify(request));\n\t\t});\n\t\tsearchInput.addEventListener('input', function () {\n\t\t\tif (this.value === '') {\n\t\t\t\tws.send(JSON.stringify({ init: true }));\n\t\t\t}\n\t\t\treturn;\n\t\t});\n\t\taddFileBtn.addEventListener('click', () => {\n\t\t\taddFileInput.click();\n\t\t});\n\t\tshowFavoriteBtn.addEventListener('click', () => {\n\t\t\tif (favoriteShowed) {\n\t\t\t\tws.send(JSON.stringify({ showAll: true }));\n\t\t\t} else {\n\t\t\t\tws.send(JSON.stringify({ showFavorite: true }));\n\t\t\t}\n\t\t});\n\t\tsendGeoBtn.addEventListener('click', () => {\n\t\t\tgetPosition(ws);\n\t\t});\n\t\tchat.addEventListener('scroll', () => {\n\t\t\tif (!chat.scrollTop && !allLoaded) {\n\t\t\t\tws.send(JSON.stringify({ init: true }))\n\t\t\t}\n\t\t})\n\t\tdragndropAddListeners(chatContainer, addPopup);\n\t\tdocument.addEventListener('dragover', (event) => event.preventDefault());\n\t\tdocument.addEventListener('drop', (event) => event.preventDefault());\n\t};\n};\n","// инициализирует отображение закрепленного сообщения\n\nimport element from './element';\nexport default function createPinned(message, server) {\n  const pinnedEl = element('div', 'messanger__pinned pinned-message');\n  const pinnedInfo = element('div', 'pinned-message__info');\n  pinnedEl.appendChild(pinnedInfo);\n\n  const pinnedTitle = element(\n    'span',\n    'pinned-message__title',\n    'Pinned message'\n  );\n  const pinnedContent = element('span', 'pinned-message__content');\n  message.content.forEach((mes) => {\n    if (mes.type === 'text') {\n      pinnedContent.textContent = `${mes.body.substr(0, 50)}...`;\n    } else if (mes.type === 'location') {\n      pinnedContent.textContent = 'Your current location';\n    } else {\n      pinnedContent.textContent = 'Message media';\n    }\n  });\n  pinnedInfo.appendChild(pinnedTitle);\n  pinnedInfo.appendChild(pinnedContent);\n\n  const closeBtn = element('button', 'pinned-message__close messanger-btn');\n  pinnedEl.appendChild(closeBtn);\n\n  pinnedEl.addEventListener('click', (event) => {\n    if (event.target === closeBtn) {\n      return;\n    }\n    document\n      .querySelector('.message-messanger[data-id=\"' + message.id + '\"]')\n      .scrollIntoView({\n        behavior: 'smooth',\n        block: 'start',\n      });\n  });\n\n  closeBtn.addEventListener('click', () => {\n    pinnedEl.remove();\n    server.send(\n      JSON.stringify({\n        unpinMessage: true,\n        pinned: false,\n        id: message.id,\n      })\n    );\n  });\n\n  return pinnedEl;\n}\n","import createMessageBody from './createMessageBody';\n\n// получение координат геопозиции и отправка тела сообщения на сервер\n\nexport default function getPosition(server) {\n  function getCoords(position) {\n    server.send(\n      createMessageBody('person', [\n        {\n          type: 'location',\n          body: `${position.coords.latitude}, ${position.coords.longitude}`,\n        },\n      ])\n    );\n  }\n  if (navigator.geolocation) {\n    navigator.geolocation.getCurrentPosition(getCoords);\n  }\n}\n"],"names":["__webpack_require__","element","tagname","classname","arguments","length","undefined","content","el","document","createElement","className","textContent","p","file","image","audio","video","Message","constructor","data","server","this","id","usertype","username","date","Date","favorite","pinned","render","messageEl","classList","add","dataset","messageInfoEl","messageAuthorEl","messageDateEl","formatDate","appendChild","messageContentEl","contentMediaEl","mediaImagesEl","checkType","messagesControllers","pinBtn","favoriteBtn","addEventListener","pin","addToFavorite","contentEl","mediaEl","mediaImages","forEach","type","textEl","innerHTML","body","replace","videoWrapper","videoEl","src","controls","videoLoader","href","download","filename","audioWrapper","audioTitle","audioEl","audioLoader","locationEl","imageWrapper","imageEl","imgLoader","fileWrapper","fileEl","icons","fileTitle","fileLoader","remove","send","JSON","stringify","pinMessage","getHours","getMinutes","createMessageBody","botname","Chatbot","description","greeting","goodbye","serials","games","greet","reply","request","test","message","random","fetch","method","headers","then","res","json","film","items","nameOriginal","posterUrlPreview","catch","err","Error","arr","Math","floor","changeHandler","event","popup","dataTransfer","target","files","Array","from","reader","FileReader","onload","ev","result","querySelector","addFile","readAsDataURL","dragndropAddListeners","preventDefault","currentTarget","dragArea","messageForm","getElementById","typeMessageInput","chatContainer","chat","addFileInput","addFileBtn","loader","loaderEl","mediaButtons","mediaControllers","recAudioBtn","recVideoBtn","clearMediaBtn","sendMediaBtn","mediaTimer","searchForm","searchInput","noResultAlarm","showFavoriteBtn","sendGeoBtn","AddFilePopup","popupOverlay","popupBody","popupFiles","popupControllers","controllersLeft","setAttribute","click","value","controllersRight","cancelBtn","removeEl","sendBtn","console","log","fileLeft","fileIcon","checkFileType","fileInfo","name","fileSize","bytes","i","parseInt","round","pow","bytesToSize","size","deleteBtn","async","children","push","split","Promise","rej","toggle","setTimeout","match","resize","height","style","scrollHeight","sendMessage","messageBody","bot","form","input","messageToBot","parse","find","cnt","reset","AudioVideoRecorder","init","audioRecorder","recVideo","navigator","mediaDevices","save","time","timer","window","MediaRecorder","disable","stream","getUserMedia","preview","muted","srcObject","play","recorder","chunks","start","setInterval","setTimer","evt","clearInterval","mediaType","blob","Blob","fr","stop","getTracks","track","e","minutes","seconds","forms","ws","WebSocket","allLoaded","onopen","botCharlie","botdata","appRecorder","addPopup","favoriteShowed","onmessage","search","messages","mes","scrollIntoView","behavior","block","lazyload","firstChild","insertBefore","showFavorite","showAll","insertAdjacentElement","pinnedEl","pinnedInfo","pinnedTitle","pinnedContent","substr","closeBtn","unpinMessage","createPinned","key","shiftKey","closest","toLowerCase","geolocation","getCurrentPosition","position","coords","latitude","longitude","scrollTop"],"sourceRoot":""}